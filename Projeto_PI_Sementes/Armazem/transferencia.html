<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Semeia Web - Transferência entre Armazéns</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root {
      --cor-primaria: #2e7d32;
      --cor-secundaria: #4caf50;
      --cor-fundo: #f4f6f5;
      --texto-principal: #333;
      --branco: #fff;
      --verde-claro: #e8f5e8;
      --verde-escuro: #0d5032;
      --verde-primario: #146c43;
      --cinza-claro: #f8f9fa;
      --cinza-medio: #e9ecef;
    }

    body {
      background-color: #f5f7f5;
      font-family: "Poppins", "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
    }

    /* ===== Sidebar ===== */
    .sidebar {
      width: 250px;
      height: 100vh;
      background-color: #146c43;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 10px;
      position: fixed;
      transition: width 0.3s ease;
      overflow: hidden;
      z-index: 1000;
    }

    .sidebar.collapsed { width: 80px; }

    .toggler {
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
      align-self: flex-start;
      margin-bottom: 15px;
      margin-left: 5px;
      transition: all 0.3s ease;
    }

    .sidebar.collapsed .toggler {
      align-self: center;
      margin: 15px 0;
    }

    .toggler:hover { transform: scale(1.1); }

    .logo {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }

    .logo img { width: 45px; transition: all 0.3s ease; }
    .logo h4 { margin: 8px 0 0 0; color: #fff; transition: opacity 0.3s ease; }

    .sidebar.collapsed .logo h4 {
      opacity: 0;
      height: 0;
      overflow: hidden;
    }

    .profile {
      text-align: center;
      margin-bottom: 30px;
      transition: all 0.3s ease;
    }

    .profile img {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: 2px solid white;
      margin-bottom: 8px;
      transition: all 0.3s ease;
    }

    .sidebar.collapsed .profile img {
      width: 45px;
      height: 45px;
    }

    .sidebar.collapsed .profile h6 {
      display: none;
    }

    .sidebar a {
      color: white;
      text-decoration: none;
      width: 100%;
      padding: 12px 20px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: background 0.3s ease, padding 0.3s ease;
    }

    .sidebar a:hover,
    .sidebar a.active { background-color: #0d5032; }

    .sidebar.collapsed a {
      justify-content: center;
      padding: 12px 0;
    }

    .sidebar.collapsed a span { display: none; }

    .logout {
      margin-top: auto;
      width: 100%;
      border-top: 1px solid rgba(255,255,255,0.2);
      padding-top: 15px;
    }

    .logout a {
      color: white;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border-radius: 10px;
      transition: background 0.3s ease;
    }

    .logout a:hover { background-color: #0d5032; }

    .sidebar.collapsed .logout a {
      justify-content: center;
      padding: 12px 0;
    }

    .sidebar.collapsed .logout a span { display: none; }

    /* ===== Conteúdo Principal ===== */
    .main-content {
      margin-left: 250px;
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: margin-left 0.3s ease, width 0.3s ease;
      width: calc(100% - 250px);
    }

    .sidebar.collapsed ~ .main-content {
      margin-left: 80px;
      width: calc(100% - 80px);
    }

    header {
      background-color: var(--branco);
      padding: 15px 25px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h4 { margin: 0; color: var(--texto-principal); }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .user-info img {
      width: 35px;
      height: 35px;
      border-radius: 50%;
    }

    main {
      flex: 1;
      padding: 25px;
      background-color: var(--cor-fundo);
    }

    /* ===== Estilos da Tela de Transferência ===== */
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .page-title {
      color: #064420;
      font-weight: 700;
      margin-bottom: 0;
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .page-title i {
      color: var(--verde-primario);
    }

    .form-container {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      margin-bottom: 30px;
    }

    .form-section {
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--cinza-medio);
    }

    .form-section:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .section-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--verde-primario);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-label {
      font-weight: 600;
      color: #064420;
      margin-bottom: 8px;
    }

    .form-control, .form-select {
      border-radius: 8px;
      border: 1px solid #ddd;
      padding: 10px 12px;
      transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--verde-primario);
      box-shadow: 0 0 0 0.2rem rgba(20, 108, 67, 0.25);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--verde-primario), var(--verde-escuro));
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, var(--verde-escuro), #064420);
      transform: translateY(-1px);
    }

    .btn-outline-secondary {
      border-radius: 8px;
      padding: 12px 24px;
      font-weight: 600;
    }

    .form-actions {
      display: flex;
      gap: 15px;
      justify-content: flex-end;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--cinza-medio);
    }

    /* Tabela de Lotes */
    .lotes-table {
      background: var(--cinza-claro);
      border-radius: 8px;
      padding: 20px;
    }

    .table th {
      background: var(--verde-claro);
      color: var(--verde-primario);
      font-weight: 600;
      border: none;
    }

    .table td {
      vertical-align: middle;
      border-color: var(--cinza-medio);
    }

    .quantidade-input {
      width: 100px;
      text-align: center;
    }

    /* Status Badges */
    .status-badge {
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .status-pendente {
      background: rgba(241, 196, 15, 0.1);
      color: #f39c12;
    }

    .status-concluida {
      background: rgba(46, 204, 113, 0.1);
      color: #27ae60;
    }

    .status-cancelada {
      background: rgba(231, 76, 60, 0.1);
      color: #c0392b;
    }

    /* Alert Styles */
    .alert-custom {
      border-radius: 8px;
      border: none;
      padding: 15px 20px;
    }

    /* Card de Resumo */
    .resumo-card {
      background: var(--verde-claro);
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
    }

    .resumo-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(20, 108, 67, 0.1);
    }

    .resumo-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      font-weight: 600;
      color: var(--verde-primario);
    }

    /* Transferências List */
    .transferencias-list {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

    .transferencia-card {
      background: var(--cinza-claro);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      border-left: 4px solid var(--verde-primario);
    }

    .transferencia-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 10px;
    }

    .transferencia-actions {
      display: flex;
      gap: 8px;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 0.8rem;
      border-radius: 6px;
    }

    /* Armazém Cards */
    .armazem-cards {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .armazem-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .armazem-card.active {
      border-color: var(--verde-primario);
      background: var(--verde-claro);
    }

    .armazem-card h6 {
      color: var(--verde-primario);
      margin-bottom: 10px;
    }

    .armazem-info {
      font-size: 0.9rem;
      color: #666;
    }

    @media (max-width: 768px) {
      .form-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .transferencia-header {
        flex-direction: column;
        gap: 10px;
      }
      
      .armazem-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- ===== Sidebar ===== -->
  <div class="sidebar" id="sidebar">
    <i class="bi bi-list toggler" id="toggle-btn"></i>

    <div class="logo">
      <img src="img/logo2.png" alt="Semeia Web">
      <h4>Semeia Web</h4>
    </div>

    <div class="profile">
      <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Usuário">
      <h6>Carlos Silva</h6>
    </div>

    <a href="dashboard_operador.html"><i class="bi bi-house-fill"></i><span>Início</span></a>
    <a href="entrada_lotes.html"><i class="bi bi-box-arrow-in-down"></i><span>Entrada de Lotes</span></a>
    <a href="expedicao.html"><i class="bi bi-truck"></i><span>Expedição</span></a>
    <a href="transferencia.html" class="active"><i class="bi bi-arrow-left-right"></i><span>Transferência</span></a>
    <a href="estoque.html"><i class="bi bi-box-seam"></i><span>Estoque</span></a>
    <a href="relatorios.html"><i class="bi bi-file-earmark-text"></i><span>Relatórios</span></a>
    <a href="notificacoes.html" class="notification-item"><i class="bi bi-bell"></i><span>Notificações</span></a>
    <a href="configuracao.html"><i class="bi bi-gear"></i><span>Configurações</span></a>

    <div class="logout">
      <a href="../login.html"><i class="bi bi-box-arrow-right"></i><span>Sair</span></a>
    </div>
  </div>

  <!-- ===== Conteúdo Principal ===== -->
  <div class="main-content">
    <header>
      <h4>Transferência entre Armazéns</h4>
      <div class="user-info">
        <span>Carlos Silva</span>
        <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Usuário">
      </div>
    </header>

    <main>
    <div class="container-fluid">
  <!-- Cabeçalho da Página -->
  <div class="page-header">
    <h1 class="page-title"><i class="bi bi-arrow-left-right"></i> Nova Transferência</h1>
    <div class="date-filter">
      <span>Data:</span>
      <input type="date" style="border: 1px solid #ddd; border-radius: 8px; padding: 8px 12px; background: white; color: #666; font-size: 0.9rem;">
    </div>
  </div>

        <!-- Alert de Informação -->
        <div class="alert alert-info alert-custom">
          <i class="bi bi-info-circle-fill"></i>
          <strong>Informação:</strong> Selecione os armazéns de origem e destino, depois escolha os lotes para transferência.
        </div>

        <!-- Formulário de Transferência -->
        <div class="form-container">
          <form id="formTransferencia">
            <!-- Seção: Armazéns de Origem e Destino -->
            <div class="form-section">
              <h3 class="section-title"><i class="bi bi-building"></i> Armazéns</h3>
              
              <div class="armazem-cards">
                <!-- Armazém Origem -->
                <div class="armazem-card" id="armazemOrigemCard">
                  <h6><i class="bi bi-arrow-up-circle"></i> Armazém de Origem</h6>
                  <div class="mb-3">
                    <label class="form-label">Selecionar Armazém <span class="text-danger">*</span></label>
                    <select class="form-select" id="armazemOrigem" required onchange="atualizarArmazemOrigem()">
                      <option value="">Selecione o armazém...</option>
                      <option value="central">Armazém Central</option>
                      <option value="norte">Armazém Norte</option>
                      <option value="sul">Armazém Sul</option>
                    </select>
                  </div>
                  <div class="armazem-info" id="infoArmazemOrigem">
                    Selecione um armazém para ver informações
                  </div>
                </div>

                <!-- Armazém Destino -->
                <div class="armazem-card" id="armazemDestinoCard">
                  <h6><i class="bi bi-arrow-down-circle"></i> Armazém de Destino</h6>
                  <div class="mb-3">
                    <label class="form-label">Selecionar Armazém <span class="text-danger">*</span></label>
                    <select class="form-select" id="armazemDestino" required onchange="atualizarArmazemDestino()">
                      <option value="">Selecione o armazém...</option>
                      <option value="central">Armazém Central</option>
                      <option value="norte">Armazém Norte</option>
                      <option value="sul">Armazém Sul</option>
                    </select>
                  </div>
                  <div class="armazem-info" id="infoArmazemDestino">
                    Selecione um armazém para ver informações
                  </div>
                </div>
              </div>

              <div class="alert alert-warning alert-custom mt-3" id="alertaMesmoArmazem" style="display: none;">
                <i class="bi bi-exclamation-triangle"></i>
                <strong>Atenção:</strong> Os armazéns de origem e destino não podem ser iguais.
              </div>
            </div>

            <!-- Seção: Seleção de Lotes -->
            <div class="form-section">
              <h3 class="section-title"><i class="bi bi-box-seam"></i> Lotes para Transferência</h3>
              
              <!-- Filtros de Lotes -->
              <div class="row g-3 mb-3">
                <div class="col-md-4">
                  <label class="form-label">Filtrar por Espécie</label>
                  <select class="form-select" id="filtroEspecie">
                    <option value="">Todas as espécies</option>
                    <option value="milho">Milho</option>
                    <option value="feijao">Feijão</option>
                    <option value="arroz">Arroz</option>
                    <option value="soja">Soja</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">Ordenar por</label>
                  <select class="form-select" id="ordenarLotes">
                    <option value="validade">Validade</option>
                    <option value="quantidade">Quantidade</option>
                    <option value="especie">Espécie</option>
                  </select>
                </div>
                <div class="col-md-4 d-flex align-items-end">
                  <button type="button" class="btn btn-outline-primary w-100" onclick="aplicarFiltrosTransferencia()">
                    <i class="bi bi-funnel"></i> Aplicar Filtros
                  </button>
                </div>
              </div>

              <!-- Tabela de Lotes Disponíveis -->
              <div class="lotes-table">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead>
                      <tr>
                        <th width="50">
                          <input type="checkbox" id="selectAllLotes" onchange="selecionarTodosLotesTransferencia()">
                        </th>
                        <th>Lote</th>
                        <th>Espécie</th>
                        <th>Disponível (kg)</th>
                        <th>Validade</th>
                        <th>Quantidade Transferir</th>
                        <th>Ações</th>
                      </tr>
                    </thead>
                    <tbody id="tabelaLotesTransferencia">
                      <tr>
                        <td><input type="checkbox" class="lote-check-transferencia" data-lote="LOT-2024-025"></td>
                        <td><strong>LOT-2024-025</strong></td>
                        <td>Milho</td>
                        <td>150 kg</td>
                        <td>15/05/2025</td>
                        <td>
                          <input type="number" class="form-control form-control-sm quantidade-input" 
                                 min="0" max="150" value="0" onchange="atualizarResumoTransferencia()">
                        </td>
                        <td>
                          <button type="button" class="btn btn-sm btn-outline-info" onclick="verDetalhesLoteTransferencia('LOT-2024-025')">
                            <i class="bi bi-eye"></i>
                          </button>
                        </td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="lote-check-transferencia" data-lote="LOT-2024-024"></td>
                        <td><strong>LOT-2024-024</strong></td>
                        <td>Feijão</td>
                        <td>80 kg</td>
                        <td>14/08/2025</td>
                        <td>
                          <input type="number" class="form-control form-control-sm quantidade-input" 
                                 min="0" max="80" value="0" onchange="atualizarResumoTransferencia()">
                        </td>
                        <td>
                          <button type="button" class="btn btn-sm btn-outline-info" onclick="verDetalhesLoteTransferencia('LOT-2024-024')">
                            <i class="bi bi-eye"></i>
                          </button>
                        </td>
                      </tr>
                      <tr>
                        <td><input type="checkbox" class="lote-check-transferencia" data-lote="LOT-2024-023"></td>
                        <td><strong>LOT-2024-023</strong></td>
                        <td>Arroz</td>
                        <td>100 kg</td>
                        <td>13/07/2025</td>
                        <td>
                          <input type="number" class="form-control form-control-sm quantidade-input" 
                                 min="0" max="100" value="0" onchange="atualizarResumoTransferencia()">
                        </td>
                        <td>
                          <button type="button" class="btn btn-sm btn-outline-info" onclick="verDetalhesLoteTransferencia('LOT-2024-023')">
                            <i class="bi bi-eye"></i>
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Resumo da Transferência -->
              <div class="resumo-card">
                <h6><i class="bi bi-clipboard-check"></i> Resumo da Transferência</h6>
                <div class="resumo-item">
                  <span>Total de Lotes Selecionados:</span>
                  <span id="totalLotesTransferencia">0</span>
                </div>
                <div class="resumo-item">
                  <span>Quantidade Total (kg):</span>
                  <span id="quantidadeTotalTransferencia">0 kg</span>
                </div>
                <div class="resumo-item">
                  <span>Espécies Incluídas:</span>
                  <span id="especiesIncluidasTransferencia">Nenhuma</span>
                </div>
                <div class="resumo-item">
                  <span>Armazém Origem → Destino:</span>
                  <span id="armazensResumo">- → -</span>
                </div>
              </div>
            </div>

            <!-- Seção: Observações -->
            <div class="form-section">
              <h3 class="section-title"><i class="bi bi-chat-left-text"></i> Observações</h3>
              <div class="row g-3">
                <div class="col-12">
                  <label class="form-label">Motivo da Transferência</label>
                  <select class="form-select" id="motivoTransferencia">
                    <option value="">Selecione o motivo...</option>
                    <option value="estoque">Ajuste de estoque</option>
                    <option value="demanda">Atendimento à demanda regional</option>
                    <option value="validade">Otimização por validade</option>
                    <option value="outro">Outro motivo</option>
                  </select>
                </div>
                <div class="col-12">
                  <label class="form-label">Observações Adicionais</label>
                  <textarea class="form-control" rows="3" placeholder="Observações sobre a transferência, instruções especiais, etc." id="observacoesTransferencia"></textarea>
                </div>
              </div>
            </div>

            <!-- Ações do Formulário -->
            <div class="form-actions">
              <button type="button" class="btn btn-outline-secondary" onclick="limparTransferencia()">
                <i class="bi bi-x-circle"></i> Cancelar
              </button>
              <button type="button" class="btn btn-outline-primary" onclick="salvarRascunhoTransferencia()">
                <i class="bi bi-save"></i> Salvar Rascunho
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-lg"></i> Confirmar Transferência
              </button>
            </div>
          </form>
        </div>

        <!-- Transferências Recentes -->
        <div class="transferencias-list">
          <h5 class="section-title"><i class="bi bi-clock-history"></i> Transferências Recentes</h5>
          
          <div class="transferencia-card">
            <div class="transferencia-header">
              <div>
                <h6 class="mb-1">TRF-2024-008 - Central → Norte</h6>
                <p class="mb-1 text-muted">Data: 15/11/2024 | Status: Concluída</p>
                <p class="mb-0"><strong>2 lotes</strong> - Total: 130 kg | Motivo: Ajuste de estoque</p>
              </div>
              <div class="transferencia-actions">
                <span class="status-badge status-concluida">Concluída</span>
                <button class="btn btn-sm btn-outline-primary">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-success">
                  <i class="bi bi-printer"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="transferencia-card">
            <div class="transferencia-header">
              <div>
                <h6 class="mb-1">TRF-2024-007 - Sul → Central</h6>
                <p class="mb-1 text-muted">Data: 14/11/2024 | Status: Pendente</p>
                <p class="mb-0"><strong>3 lotes</strong> - Total: 200 kg | Motivo: Atendimento à demanda</p>
              </div>
              <div class="transferencia-actions">
                <span class="status-badge status-pendente">Pendente</span>
                <button class="btn btn-sm btn-outline-primary">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-warning" onclick="editarTransferencia('TRF-2024-007')">
                  <i class="bi bi-pencil"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="transferencia-card">
            <div class="transferencia-header">
              <div>
                <h6 class="mb-1">TRF-2024-006 - Norte → Sul</h6>
                <p class="mb-1 text-muted">Data: 13/11/2024 | Status: Concluída</p>
                <p class="mb-0"><strong>1 lote</strong> - Total: 80 kg | Motivo: Otimização por validade</p>
              </div>
              <div class="transferencia-actions">
                <span class="status-badge status-concluida">Concluída</span>
                <button class="btn btn-sm btn-outline-primary">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-sm btn-outline-success">
                  <i class="bi bi-printer"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Sidebar Toggle
    const sidebar = document.getElementById("sidebar");
    const toggleBtn = document.getElementById("toggle-btn");
    toggleBtn.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
    });

    // Dados dos Armazéns (simulação)
    const dadosArmazens = {
      'central': {
        nome: 'Armazém Central',
        capacidade: '5000 kg',
        ocupacao: '65%',
        responsavel: 'Maria Santos',
        telefone: '(81) 99999-9999'
      },
      'norte': {
        nome: 'Armazém Norte', 
        capacidade: '3000 kg',
        ocupacao: '45%',
        responsavel: 'João Silva',
        telefone: '(81) 98888-8888'
      },
      'sul': {
        nome: 'Armazém Sul',
        capacidade: '4000 kg',
        ocupacao: '55%',
        responsavel: 'Ana Oliveira',
        telefone: '(81) 97777-7777'
      }
    };

    // Funções da Transferência
    function atualizarArmazemOrigem() {
      const select = document.getElementById('armazemOrigem');
      const valor = select.value;
      const card = document.getElementById('armazemOrigemCard');
      const info = document.getElementById('infoArmazemOrigem');
      
      if (valor) {
        card.classList.add('active');
        const dados = dadosArmazens[valor];
        info.innerHTML = `
          <strong>Capacidade:</strong> ${dados.capacidade}<br>
          <strong>Ocupação:</strong> ${dados.ocupacao}<br>
          <strong>Responsável:</strong> ${dados.responsavel}<br>
          <strong>Telefone:</strong> ${dados.telefone}
        `;
      } else {
        card.classList.remove('active');
        info.textContent = 'Selecione um armazém para ver informações';
      }
      
      validarArmazens();
      carregarLotesDisponiveis();
    }

    function atualizarArmazemDestino() {
      const select = document.getElementById('armazemDestino');
      const valor = select.value;
      const card = document.getElementById('armazemDestinoCard');
      const info = document.getElementById('infoArmazemDestino');
      
      if (valor) {
        card.classList.add('active');
        const dados = dadosArmazens[valor];
        info.innerHTML = `
          <strong>Capacidade:</strong> ${dados.capacidade}<br>
          <strong>Ocupação:</strong> ${dados.ocupacao}<br>
          <strong>Responsável:</strong> ${dados.responsavel}<br>
          <strong>Telefone:</strong> ${dados.telefone}
        `;
      } else {
        card.classList.remove('active');
        info.textContent = 'Selecione um armazém para ver informações';
      }
      
      validarArmazens();
      atualizarResumoTransferencia();
    }

    function validarArmazens() {
      const origem = document.getElementById('armazemOrigem').value;
      const destino = document.getElementById('armazemDestino').value;
      const alerta = document.getElementById('alertaMesmoArmazem');
      
      if (origem && destino && origem === destino) {
        alerta.style.display = 'block';
      } else {
        alerta.style.display = 'none';
      }
    }

    function carregarLotesDisponiveis() {
      const armazemOrigem = document.getElementById('armazemOrigem').value;
      if (armazemOrigem) {
        // Simular carregamento de lotes do armazém selecionado
        console.log(`Carregando lotes do armazém: ${armazemOrigem}`);
      }
    }

    function selecionarTodosLotesTransferencia() {
      const selectAll = document.getElementById('selectAllLotes');
      const checkboxes = document.querySelectorAll('.lote-check-transferencia');
      
      checkboxes.forEach(checkbox => {
        checkbox.checked = selectAll.checked;
      });
      
      atualizarResumoTransferencia();
    }

    function atualizarResumoTransferencia() {
      const checkboxes = document.querySelectorAll('.lote-check-transferencia:checked');
      const quantidadeInputs = document.querySelectorAll('.quantidade-input');
      
      let totalLotes = 0;
      let quantidadeTotal = 0;
      const especies = new Set();
      
      checkboxes.forEach((checkbox, index) => {
        const quantidade = parseInt(quantidadeInputs[index].value) || 0;
        if (quantidade > 0) {
          totalLotes++;
          quantidadeTotal += quantidade;
          
          // Obter espécie da linha da tabela
          const linha = checkbox.closest('tr');
          const especie = linha.cells[2].textContent.trim();
          especies.add(especie);
        }
      });
      
      // Atualizar resumo
      document.getElementById('totalLotesTransferencia').textContent = totalLotes;
      document.getElementById('quantidadeTotalTransferencia').textContent = quantidadeTotal + ' kg';
      document.getElementById('especiesIncluidasTransferencia').textContent = especies.size > 0 ? 
        Array.from(especies).join(', ') : 'Nenhuma';
      
      // Atualizar armazéns no resumo
      const origemSelect = document.getElementById('armazemOrigem');
      const destinoSelect = document.getElementById('armazemDestino');
      const origem = origemSelect.options[origemSelect.selectedIndex].text;
      const destino = destinoSelect.options[destinoSelect.selectedIndex].text;
      
      document.getElementById('armazensResumo').textContent = 
        (origem !== 'Selecione o armazém...' && destino !== 'Selecione o armazém...') ? 
        `${origem} → ${destino}` : '- → -';
    }

    function aplicarFiltrosTransferencia() {
      const especieFiltro = document.getElementById('filtroEspecie').value;
      const ordenacao = document.getElementById('ordenarLotes').value;
      
      // Simular aplicação de filtros
      alert(`Filtros aplicados:\nEspécie: ${especieFiltro || 'Todas'}\nOrdenação: ${ordenacao}`);
    }

    function verDetalhesLoteTransferencia(numeroLote) {
      alert(`Detalhes do Lote: ${numeroLote}\n\nEspécie: Milho\nQuantidade Disponível: 150 kg\nValidade: 15/05/2025\nLocalização: Setor A, Prateleira 3`);
    }

    function limparTransferencia() {
      if (confirm('Tem certeza que deseja cancelar esta transferência? Todos os dados serão perdidos.')) {
        document.getElementById('formTransferencia').reset();
        document.getElementById('selectAllLotes').checked = false;
        
        // Limpar checkboxes e quantidades
        const checkboxes = document.querySelectorAll('.lote-check-transferencia');
        const quantidadeInputs = document.querySelectorAll('.quantidade-input');
        
        checkboxes.forEach(checkbox => checkbox.checked = false);
        quantidadeInputs.forEach(input => input.value = 0);
        
        // Resetar cards dos armazéns
        document.getElementById('armazemOrigemCard').classList.remove('active');
        document.getElementById('armazemDestinoCard').classList.remove('active');
        document.getElementById('infoArmazemOrigem').textContent = 'Selecione um armazém para ver informações';
        document.getElementById('infoArmazemDestino').textContent = 'Selecione um armazém para ver informações';
        
        atualizarResumoTransferencia();
      }
    }

    function salvarRascunhoTransferencia() {
      alert('Rascunho da transferência salvo com sucesso! Você pode continuar editando posteriormente.');
    }

    function editarTransferencia(numeroTransferencia) {
      alert(`Editando transferência: ${numeroTransferencia}\n\nEsta funcionalidade permitiria editar uma transferência existente.`);
    }

    // Event Listeners
    document.querySelectorAll('.quantidade-input').forEach(input => {
      input.addEventListener('input', atualizarResumoTransferencia);
    });

    document.querySelectorAll('.lote-check-transferencia').forEach(checkbox => {
      checkbox.addEventListener('change', atualizarResumoTransferencia);
    });

    // Submit do Formulário
    document.getElementById('formTransferencia').addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Validações
      const armazemOrigem = document.getElementById('armazemOrigem').value;
      const armazemDestino = document.getElementById('armazemDestino').value;
      const lotesSelecionados = document.querySelectorAll('.lote-check-transferencia:checked');
      
      if (!armazemOrigem || !armazemDestino) {
        alert('Por favor, selecione os armazéns de origem e destino.');
        return;
      }
      
      if (armazemOrigem === armazemDestino) {
        alert('Os armazéns de origem e destino não podem ser iguais.');
        return;
      }
      
      if (lotesSelecionados.length === 0) {
        alert('Por favor, selecione pelo menos um lote para transferência.');
        return;
      }
      
      // Verificar se há quantidades definidas
      let temQuantidade = false;
      document.querySelectorAll('.quantidade-input').forEach(input => {
        if (parseInt(input.value) > 0) {
          temQuantidade = true;
        }
      });
      
      if (!temQuantidade) {
        alert('Por favor, defina as quantidades para os lotes selecionados.');
        return;
      }
      
      // Simular criação da transferência
      const numeroTransferencia = 'TRF-2024-' + Math.floor(Math.random() * 1000).toString().padStart(3, '0');
      alert(`Transferência criada com sucesso!\n\nNúmero: ${numeroTransferencia}\nOrigem → Destino: ${document.getElementById('armazemOrigem').options[document.getElementById('armazemOrigem').selectedIndex].text} → ${document.getElementById('armazemDestino').options[document.getElementById('armazemDestino').selectedIndex].text}\nTotal: ${document.getElementById('quantidadeTotalTransferencia').textContent}`);
      
      // Limpar formulário
      limparTransferencia();
    });
  </script>
</body>
</html>